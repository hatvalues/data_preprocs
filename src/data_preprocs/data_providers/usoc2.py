from src.data_preprocs.data_loading import DataFramework, DataProviderFactory
import polars as pl

usoc2_pandas_schema = {
    "wave": "object",
    "alb": "int16",
    "alkp": "int16",
    "alt": "int16",
    "ast": "int16",
    "chol": "float16",
    "dheas": "float16",
    "ecre": "float16",
    "ggt": "float16",
    "hba1c": "int16",
    "hdl": "float16",
    "hscrp": "float16",
    "igfi": "float16",
    "rtin": "float16",
    "testo": "float16",
    "trig": "float16",
    "ure": "float16",
    "hgb": "float16",
    "cfib": "float16",
    "uscmg": "object",
    "uscmm": "object",
    "cmvavc": "object",
    "hhorig": "object",
    "indbdub_xw": "float16",
    "nsex": "object",
    "confage": "float16",
    "region": "object",
    "medcnjd": "object",
    "tbmed": "object",
    "statins": "object",
    "statina": "object",
    "folic": "object",
    "folpreghr": "object",
    "diur": "object",
    "beta": "object",
    "aceinh": "object",
    "calciumb": "object",
    "obpdrug": "object",
    "bpmedc": "object",
    "lipid": "object",
    "iron": "object",
    "medtyp1": "object",
    "medtyp2": "object",
    "medtyp3": "object",
    "medtyp4": "object",
    "medtyp5": "object",
    "medtyp6": "object",
    "medtyp7": "object",
    "medtyp8": "object",
    "medtyp9": "object",
    "medtyp10": "object",
    "medtyp11": "object",
    "medtyp12": "object",
    "medtyp13": "object",
    "medcnj": "object",
    "resphts": "object",
    "estht": "float16",
    "nohtbc1": "object",
    "nohtbc2": "object",
    "nohtbc3": "object",
    "nohtbc4": "object",
    "nohtbc5": "object",
    "nohtbc6": "object",
    "nohtbc7": "object",
    "nohtbc8": "object",
    "relhite": "object",
    "hinrel": "object",
    "respwts": "object",
    "bfpc": "float16",
    "bfpcok": "object",
    "bfpcval": "float16",
    "nobf1": "object",
    "nobf2": "object",
    "nobf3": "object",
    "resnwt": "object",
    "nowtbc1": "object",
    "nowtbc2": "object",
    "nowtbc3": "object",
    "nowtbc4": "object",
    "nowtbc5": "object",
    "nowtbc6": "object",
    "nowtbc7": "object",
    "nowtbc8": "object",
    "nowtbc9": "object",
    "ewtch": "object",
    "estwt": "float16",
    "floorc": "object",
    "relwaitb": "object",
    "whintro": "object",
    "ynowh": "object",
    "whpnabm1": "object",
    "whpnabm2": "object",
    "whpnabm3": "object",
    "whpnabm4": "object",
    "whpnabm5": "object",
    "whpnabm6": "object",
    "whpnabm95": "object",
    "wjrel": "object",
    "probwj": "object",
    "bpconst": "object",
    "consubx1": "object",
    "consubx2": "object",
    "consubx3": "object",
    "consubx4": "object",
    "consubx5": "object",
    "omronno": "int16",
    "cufsize": "object",
    "airtemp": "float16",
    "ynobp": "object",
    "respbps": "object",
    "nattbpd0": "object",
    "nattbpd1": "object",
    "nattbpd2": "object",
    "nattbpd3": "object",
    "nattbpd4": "object",
    "nattbpd95": "object",
    "difbpc1": "object",
    "difbpc2": "object",
    "difbpc3": "object",
    "difbpc4": "object",
    "difbpc5": "object",
    "difbpc6": "object",
    "difbpc95": "object",
    "mmgswil": "object",
    "mmgsok": "object",
    "mmgsdval": "int16",
    "mmgsnval": "int16",
    "mmgsdom": "object",
    "mmgssta": "object",
    "mmgsd1": "int16",
    "mmgsn1": "int16",
    "mmgsd2": "int16",
    "mmgsn2": "int16",
    "mmgsd3": "int16",
    "mmgsn3": "int16",
    "mmgstp": "object",
    "mmgsres": "object",
    "mmgsprb1": "object",
    "mmgsprb2": "object",
    "mmgsprb3": "object",
    "mmgsprb95": "object",
    "lungsurg": "object",
    "lungeye": "object",
    "lunghrt": "object",
    "lunghosp": "object",
    "lungex": "object",
    "lungtest": "object",
    "noattlf0": "object",
    "noattlf1": "object",
    "noattlf2": "object",
    "noattlf3": "object",
    "noattlf4": "object",
    "noattlf5": "object",
    "noattlf95": "object",
    "lungsmok": "object",
    "lungsmhr": "int16",
    "lunginhl": "object",
    "lunginhr": "int16",
    "htfvc": "float16",
    "htfev": "float16",
    "htpef": "float16",
    "htfevfvc": "float16",
    "fev1pred": "float16",
    "fvcpred": "float16",
    "fev1fvcp": "float16",
    "htfvc_sc": "float16",
    "htfev_sc": "float16",
    "htpef_sc": "float16",
    "htfevfvc_sc": "float16",
    "fev1pred_sc": "float16",
    "fvcpred_sc": "float16",
    "fev1fvcp_sc": "float16",
    "qualcdf0": "object",
    "qualcdf1": "object",
    "qualcdf2": "object",
    "qualcdf3": "object",
    "qualcdf4": "object",
    "qualcdf5": "object",
    "qualcdf6": "object",
    "qualcdf7": "object",
    "qualcdf95": "object",
    "qualab": "object",
    "nulllf0": "object",
    "nulllf1": "object",
    "nulllf2": "object",
    "nulllf3": "object",
    "nulllf4": "object",
    "nulllf5": "object",
    "nulllf6": "object",
    "nulllf95": "object",
    "hasurg": "object",
    "haeysurg": "object",
    "hastro": "object",
    "chestinf": "object",
    "inhaler": "object",
    "inhalhrs": "int16",
    "lfwill": "object",
    "spirno": "int16",
    "lftemp": "float16",
    "noread": "object",
    "nlsatlf": "object",
    "htfvc2": "float16",
    "ynolf": "object",
    "lfstand": "object",
    "lfresp": "object",
    "problf1": "object",
    "problf2": "object",
    "problf3": "object",
    "problf4": "object",
    "problf5": "object",
    "noattlf": "object",
    "ncgplf": "object",
    "ncguard": "object",
    "clotb": "object",
    "fit": "object",
    "bswill": "object",
    "refbsc1": "object",
    "refbsc2": "object",
    "refbsc3": "object",
    "refbsc4": "object",
    "refbsc5": "object",
    "refbsc6": "object",
    "refbsc7": "object",
    "refbsc95": "object",
    "constorb": "object",
    "condna": "object",
    "samparm": "object",
    "samdifc1": "object",
    "samdifc2": "object",
    "samdifc3": "object",
    "samdifc4": "object",
    "samdifc5": "object",
    "samdifc6": "object",
    "samdifc95": "object",
    "nobsm1": "object",
    "nobsm2": "object",
    "nobsm3": "object",
    "nobsm95": "object",
    "vpsys": "object",
    "vphand": "object",
    "vparm": "object",
    "vpskin": "object",
    "vpalco": "object",
    "vpsam": "object",
    "vppress1": "object",
    "vppress2": "object",
    "vppress3": "object",
    "vpsens": "object",
    "vpprob1": "object",
    "vpprob2": "object",
    "vpprob3": "object",
    "vpprob95": "object",
    "vpprob96": "object",
    "vpcheck": "object",
    "nseqno": "object",
    "dateok": "object",
    "wtpc": "float16",
    "feet": "object",
    "mmgspr": "object",
    "antic": "object",
    "bfck2": "object",
    "nuroutc": "object",
    "bsoute": "object",
    "htok": "object",
    "wtok": "object",
    "bmiok": "object",
    "htval": "float16",
    "wtval": "float16",
    "bmivg5": "object",
    "lfout": "object",
    "numed2": "int16",
    "nurdayd": "int16",
    "nurdaym": "int16",
    "nurdayy": "object",
    "nurdayw": "object",
    "elig": "object",
    "ethnic": "object",
    "sys1": "int16",
    "dias1": "int16",
    "pulse1": "int16",
    "map1": "int16",
    "full1": "object",
    "sys2": "int16",
    "dias2": "int16",
    "pulse2": "int16",
    "map2": "int16",
    "full2": "object",
    "sys3": "int16",
    "dias3": "int16",
    "pulse3": "int16",
    "map3": "int16",
    "full3": "object",
    "omsysval": "float16",
    "omdiaval": "float16",
    "ompulval": "float16",
    "ommapval": "float16",
    "omsyst": "float16",
    "omdiast": "float16",
    "bprespc": "object",
    "hyper2om": "object",
    "wstokb": "object",
    "wstval": "float16",
    "hhsize": "int16",
    "ieqmoecd_dv": "float16",
    "hhtype_dv": "object",
    "jbstat": "object",
    "mlstat": "object",
    "sf1": "object",
    "health": "object",
    "marstat": "object",
    "scghqa": "object",
    "scghqb": "object",
    "scghqc": "object",
    "scghqd": "object",
    "scghqe": "object",
    "scghqf": "object",
    "scghqg": "object",
    "scghqh": "object",
    "scghqi": "object",
    "scghqj": "object",
    "scghqk": "object",
    "scghql": "object",
    "scghq1_dv": "int16",
    "scghq2_dv": "int16",
    "hiqual_dv": "object",
    "jbnssec8_dv": "object",
    "jbnssec5_dv": "object",
    "jbnssec3_dv": "object",
    "jlnssec8_dv": "object",
    "jlnssec5_dv": "object",
    "jlnssec3_dv": "object",
    "urban_dv": "object",
    "bmival": "float16",
    "hyper1": "object",
    "hyper2": "object",
    "bnf7_conhrt": "object",
    "bnf7_antifibs": "object",
    "bnf7_aspirin": "object",
    "bnf7_statins": "object",
    "bnf7_antiinflam": "object",
    "bnf7_antiep": "object",
    "mh": "object",
}

usoc2_polars_schema = {
    "level_0": pl.Int64,
    "index": pl.Int64,
    "wave": pl.Int64,
    "alb": pl.Int64,
    "alkp": pl.Int64,
    "alt": pl.Int64,
    "ast": pl.Int64,
    "chol": pl.Float64,
    "dheas": pl.Float64,
    "ecre": pl.Int64,
    "ggt": pl.Int64,
    "hba1c": pl.Int64,
    "hdl": pl.Float64,
    "hscrp": pl.Float64,
    "igfi": pl.Int64,
    "rtin": pl.Int64,
    "testo": pl.Float64,
    "trig": pl.Float64,
    "ure": pl.Float64,
    "hgb": pl.Int64,
    "cfib": pl.Float64,
    "uscmg": pl.Int64,
    "uscmm": pl.Int64,
    "cmvavc": pl.Int64,
    "hhorig": pl.Int64,
    "indbdub_xw": pl.Float64,
    "nsex": pl.Int64,
    "confage": pl.Int64,
    "region": pl.Int64,
    "medcnjd": pl.Int64,
    "tbmed": pl.Int64,
    "statins": pl.Int64,
    "statina": pl.Int64,
    "folic": pl.Int64,
    "folpreghr": pl.Int64,
    "diur": pl.Int64,
    "beta": pl.Int64,
    "aceinh": pl.Int64,
    "calciumb": pl.Int64,
    "obpdrug": pl.Int64,
    "bpmedc": pl.Int64,
    "lipid": pl.Int64,
    "iron": pl.Int64,
    "medtyp1": pl.Int64,
    "medtyp2": pl.Int64,
    "medtyp3": pl.Int64,
    "medtyp4": pl.Int64,
    "medtyp5": pl.Int64,
    "medtyp6": pl.Int64,
    "medtyp7": pl.Int64,
    "medtyp8": pl.Int64,
    "medtyp9": pl.Int64,
    "medtyp10": pl.Int64,
    "medtyp11": pl.Int64,
    "medtyp12": pl.Int64,
    "medtyp13": pl.Int64,
    "medcnj": pl.Int64,
    "resphts": pl.Int64,
    "estht": pl.Float64,
    "nohtbc1": pl.Int64,
    "nohtbc2": pl.Int64,
    "nohtbc3": pl.Int64,
    "nohtbc4": pl.Int64,
    "nohtbc5": pl.Int64,
    "nohtbc6": pl.Int64,
    "nohtbc7": pl.Int64,
    "nohtbc8": pl.Int64,
    "relhite": pl.Int64,
    "hinrel": pl.Int64,
    "respwts": pl.Int64,
    "bfpc": pl.Float64,
    "bfpcok": pl.Int64,
    "bfpcval": pl.Float64,
    "nobf1": pl.Int64,
    "nobf2": pl.Int64,
    "nobf3": pl.Int64,
    "resnwt": pl.Int64,
    "nowtbc1": pl.Int64,
    "nowtbc2": pl.Int64,
    "nowtbc3": pl.Int64,
    "nowtbc4": pl.Int64,
    "nowtbc5": pl.Int64,
    "nowtbc6": pl.Int64,
    "nowtbc7": pl.Int64,
    "nowtbc8": pl.Int64,
    "nowtbc9": pl.Int64,
    "ewtch": pl.Int64,
    "estwt": pl.Float64,
    "floorc": pl.Int64,
    "relwaitb": pl.Int64,
    "whintro": pl.Int64,
    "ynowh": pl.Int64,
    "whpnabm1": pl.Int64,
    "whpnabm2": pl.Int64,
    "whpnabm3": pl.Int64,
    "whpnabm4": pl.Int64,
    "whpnabm5": pl.Int64,
    "whpnabm6": pl.Int64,
    "whpnabm95": pl.Int64,
    "wjrel": pl.Int64,
    "probwj": pl.Int64,
    "bpconst": pl.Int64,
    "consubx1": pl.Int64,
    "consubx2": pl.Int64,
    "consubx3": pl.Int64,
    "consubx4": pl.Int64,
    "consubx5": pl.Int64,
    "omronno": pl.Int64,
    "cufsize": pl.Int64,
    "airtemp": pl.Float64,
    "ynobp": pl.Int64,
    "respbps": pl.Int64,
    "nattbpd0": pl.Int64,
    "nattbpd1": pl.Int64,
    "nattbpd2": pl.Int64,
    "nattbpd3": pl.Int64,
    "nattbpd4": pl.Int64,
    "nattbpd95": pl.Int64,
    "difbpc1": pl.Int64,
    "difbpc2": pl.Int64,
    "difbpc3": pl.Int64,
    "difbpc4": pl.Int64,
    "difbpc5": pl.Int64,
    "difbpc6": pl.Int64,
    "difbpc95": pl.Int64,
    "mmgswil": pl.Int64,
    "mmgsok": pl.Int64,
    "mmgsdval": pl.Int64,
    "mmgsnval": pl.Int64,
    "mmgsdom": pl.Int64,
    "mmgssta": pl.Int64,
    "mmgsd1": pl.Int64,
    "mmgsn1": pl.Int64,
    "mmgsd2": pl.Int64,
    "mmgsn2": pl.Int64,
    "mmgsd3": pl.Int64,
    "mmgsn3": pl.Int64,
    "mmgstp": pl.Int64,
    "mmgsres": pl.Int64,
    "mmgsprb1": pl.Int64,
    "mmgsprb2": pl.Int64,
    "mmgsprb3": pl.Int64,
    "mmgsprb95": pl.Int64,
    "lungsurg": pl.Int64,
    "lungeye": pl.Int64,
    "lunghrt": pl.Int64,
    "lunghosp": pl.Int64,
    "lungex": pl.Int64,
    "lungtest": pl.Int64,
    "noattlf0": pl.Int64,
    "noattlf1": pl.Int64,
    "noattlf2": pl.Int64,
    "noattlf3": pl.Int64,
    "noattlf4": pl.Int64,
    "noattlf5": pl.Int64,
    "noattlf95": pl.Int64,
    "lungsmok": pl.Int64,
    "lungsmhr": pl.Int64,
    "lunginhl": pl.Int64,
    "lunginhr": pl.Int64,
    "htfvc": pl.Float64,
    "htfev": pl.Float64,
    "htpef": pl.Int64,
    "htfevfvc": pl.Float64,
    "fev1pred": pl.Float64,
    "fvcpred": pl.Float64,
    "fev1fvcp": pl.Float64,
    "htfvc_sc": pl.Float64,
    "htfev_sc": pl.Float64,
    "htpef_sc": pl.Float64,
    "htfevfvc_sc": pl.Float64,
    "fev1pred_sc": pl.Float64,
    "fvcpred_sc": pl.Float64,
    "fev1fvcp_sc": pl.Float64,
    "qualcdf0": pl.Int64,
    "qualcdf1": pl.Int64,
    "qualcdf2": pl.Int64,
    "qualcdf3": pl.Int64,
    "qualcdf4": pl.Int64,
    "qualcdf5": pl.Int64,
    "qualcdf6": pl.Int64,
    "qualcdf7": pl.Int64,
    "qualcdf95": pl.Int64,
    "qualab": pl.Int64,
    "nulllf0": pl.Int64,
    "nulllf1": pl.Int64,
    "nulllf2": pl.Int64,
    "nulllf3": pl.Int64,
    "nulllf4": pl.Int64,
    "nulllf5": pl.Int64,
    "nulllf6": pl.Int64,
    "nulllf95": pl.Int64,
    "hasurg": pl.Int64,
    "haeysurg": pl.Int64,
    "hastro": pl.Int64,
    "chestinf": pl.Int64,
    "inhaler": pl.Int64,
    "inhalhrs": pl.Int64,
    "lfwill": pl.Int64,
    "spirno": pl.Int64,
    "lftemp": pl.Float64,
    "noread": pl.Int64,
    "nlsatlf": pl.Int64,
    "htfvc2": pl.Float64,
    "ynolf": pl.Int64,
    "lfstand": pl.Int64,
    "lfresp": pl.Int64,
    "problf1": pl.Int64,
    "problf2": pl.Int64,
    "problf3": pl.Int64,
    "problf4": pl.Int64,
    "problf5": pl.Int64,
    "noattlf": pl.Int64,
    "ncgplf": pl.Int64,
    "ncguard": pl.Int64,
    "clotb": pl.Int64,
    "fit": pl.Int64,
    "bswill": pl.Int64,
    "refbsc1": pl.Int64,
    "refbsc2": pl.Int64,
    "refbsc3": pl.Int64,
    "refbsc4": pl.Int64,
    "refbsc5": pl.Int64,
    "refbsc6": pl.Int64,
    "refbsc7": pl.Int64,
    "refbsc95": pl.Int64,
    "constorb": pl.Int64,
    "condna": pl.Int64,
    "samparm": pl.Int64,
    "samdifc1": pl.Int64,
    "samdifc2": pl.Int64,
    "samdifc3": pl.Int64,
    "samdifc4": pl.Int64,
    "samdifc5": pl.Int64,
    "samdifc6": pl.Int64,
    "samdifc95": pl.Int64,
    "nobsm1": pl.Int64,
    "nobsm2": pl.Int64,
    "nobsm3": pl.Int64,
    "nobsm95": pl.Int64,
    "vpsys": pl.Int64,
    "vphand": pl.Int64,
    "vparm": pl.Int64,
    "vpskin": pl.Int64,
    "vpalco": pl.Int64,
    "vpsam": pl.Int64,
    "vppress1": pl.Int64,
    "vppress2": pl.Int64,
    "vppress3": pl.Int64,
    "vpsens": pl.Int64,
    "vpprob1": pl.Int64,
    "vpprob2": pl.Int64,
    "vpprob3": pl.Int64,
    "vpprob95": pl.Int64,
    "vpprob96": pl.Int64,
    "vpcheck": pl.Int64,
    "nseqno": pl.Int64,
    "dateok": pl.Int64,
    "wtpc": pl.Float64,
    "feet": pl.Int64,
    "mmgspr": pl.Int64,
    "antic": pl.Int64,
    "bfck2": pl.Int64,
    "nuroutc": pl.Int64,
    "bsoute": pl.Int64,
    "htok": pl.Int64,
    "wtok": pl.Int64,
    "bmiok": pl.Int64,
    "htval": pl.Float64,
    "wtval": pl.Float64,
    "bmivg5": pl.Int64,
    "lfout": pl.Int64,
    "numed2": pl.Int64,
    "nurdayd": pl.Int64,
    "nurdaym": pl.Int64,
    "nurdayy": pl.Int64,
    "nurdayw": pl.Int64,
    "elig": pl.Int64,
    "ethnic": pl.Int64,
    "sys1": pl.Int64,
    "dias1": pl.Int64,
    "pulse1": pl.Int64,
    "map1": pl.Int64,
    "full1": pl.Int64,
    "sys2": pl.Int64,
    "dias2": pl.Int64,
    "pulse2": pl.Int64,
    "map2": pl.Int64,
    "full2": pl.Int64,
    "sys3": pl.Int64,
    "dias3": pl.Int64,
    "pulse3": pl.Int64,
    "map3": pl.Int64,
    "full3": pl.Int64,
    "omsysval": pl.Float64,
    "omdiaval": pl.Float64,
    "ompulval": pl.Float64,
    "ommapval": pl.Float64,
    "omsyst": pl.Float64,
    "omdiast": pl.Float64,
    "bprespc": pl.Int64,
    "hyper2om": pl.Int64,
    "wstokb": pl.Int64,
    "wstval": pl.Float64,
    "hhsize": pl.Int64,
    "ieqmoecd_dv": pl.Float64,
    "hhtype_dv": pl.Int64,
    "jbstat": pl.Int64,
    "mlstat": pl.Int64,
    "sf1": pl.Int64,
    "health": pl.Int64,
    "marstat": pl.Int64,
    "hiqual_dv": pl.Int64,
    "jbnssec8_dv": pl.Int64,
    "jbnssec5_dv": pl.Int64,
    "jbnssec3_dv": pl.Int64,
    "jlnssec8_dv": pl.Int64,
    "jlnssec5_dv": pl.Int64,
    "jlnssec3_dv": pl.Int64,
    "urban_dv": pl.Int64,
    "bmival": pl.Float64,
    "hyper1": pl.Int64,
    "hyper2": pl.Int64,
    "bnf7_conhrt": pl.Int64,
    "bnf7_antifibs": pl.Int64,
    "bnf7_aspirin": pl.Int64,
    "bnf7_statins": pl.Int64,
    "bnf7_antiinflam": pl.Int64,
    "bnf7_antiep": pl.Int64,
    "mh": pl.String,
}

usoc2_common_args = {
    "name": "usoc2",
    "class_col": "mh",
    "positive_class": None,
    "spiel": """
    University of Essex, Institute for Social and Economic Research. (2019).
    Understanding Society: Waves 2-3 Nurse Health Assessment, 2010-2012. [data collection].
    3rd Edition. UK Data Service. SN: 7251, http://doi.org/10.5255/UKDA-SN-7251-3
    Target: Mental health (mh) - neutral, happy, unhappy (categorical)
    """,
}

usoc2_full_args = {"name": "usoc2", "file_name": "usoc2.csv.gz", "sample_size": 1.0}
usoc2_samp_args = {"name": "usoc2_samp", "file_name": "usoc2_samp.csv.gz", "sample_size": 0.1}

factory = DataProviderFactory(kwargs=usoc2_common_args | usoc2_full_args | {"data_framework": DataFramework.PANDAS, "schema": usoc2_pandas_schema})
usoc2_pd = factory.create_data_provider()

factory = DataProviderFactory(kwargs=usoc2_common_args | usoc2_full_args | {"data_framework": DataFramework.POLARS, "schema": usoc2_polars_schema})
usoc2_pl = factory.create_data_provider()
usoc2_pl.features = usoc2_pl.features.drop(["level_0", "index"])

factory = DataProviderFactory(kwargs=usoc2_common_args | usoc2_samp_args | {"data_framework": DataFramework.PANDAS, "schema": usoc2_pandas_schema})
usoc2_samp_pd = factory.create_data_provider()

factory = DataProviderFactory(kwargs=usoc2_common_args | usoc2_samp_args | {"data_framework": DataFramework.POLARS, "schema": usoc2_polars_schema})
usoc2_samp_pl = factory.create_data_provider()
usoc2_samp_pl.features = usoc2_samp_pl.features.drop(["level_0", "index"])
